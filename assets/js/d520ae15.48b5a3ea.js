"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[721],{876:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>m});var a=n(2784);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var u=a.createContext({}),p=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=p(e.components);return a.createElement(u.Provider,{value:t},e.children)},g="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,u=e.parentName,s=o(e,["components","mdxType","originalType","parentName"]),g=p(n),c=i,m=g["".concat(u,".").concat(c)]||g[c]||d[c]||r;return n?a.createElement(m,l(l({ref:t},s),{},{components:n})):a.createElement(m,l({ref:t},s))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=c;var o={};for(var u in t)hasOwnProperty.call(t,u)&&(o[u]=t[u]);o.originalType=e,o[g]="string"==typeof e?e:i,l[1]=o;for(var p=2;p<r;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},3866:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>o,toc:()=>p});var a=n(7896),i=(n(2784),n(876));const r={id:"signing-your-plugin",title:"Signing Your Plugin",sidebar_position:2},l=void 0,o={unversionedId:"distribution/signing-your-plugin",id:"distribution/signing-your-plugin",title:"Signing Your Plugin",description:"Grafana requires all plugins to be signed so that we can verify their authenticity with signature verification.",source:"@site/../docs/distribution/signing-your-plugin.md",sourceDirName:"distribution",slug:"/distribution/signing-your-plugin",permalink:"/plugin-tools/docs/distribution/signing-your-plugin",draft:!1,editUrl:"https://github.com/grafana/plugin-tools/edit/main/docusaurus/website/../docs/distribution/signing-your-plugin.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"signing-your-plugin",title:"Signing Your Plugin",sidebar_position:2},sidebar:"docs",previous:{title:"Distributing Your Plugin",permalink:"/plugin-tools/docs/distribution/distributing-your-plugin"},next:{title:"Advanced Configuration",permalink:"/plugin-tools/docs/advanced-usage/advanced-configuration"}},u={},p=[{value:"Generate an API key",id:"generate-an-api-key",level:2},{value:"Sign a public plugin",id:"sign-a-public-plugin",level:2},{value:"Sign a private plugin",id:"sign-a-private-plugin",level:2},{value:"Plugin signature levels",id:"plugin-signature-levels",level:2},{value:"Plugin manifest",id:"plugin-manifest",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Why do I get a &quot;Modified signature&quot; error?",id:"why-do-i-get-a-modified-signature-error",level:3},{value:"Why do I get a &quot;Field is required: <code>rootUrls</code>&quot; error for my public plugin?",id:"why-do-i-get-a-field-is-required-rooturls-error-for-my-public-plugin",level:3},{value:"Why do I get a &quot;Field is required: <code>rootUrls</code>&quot; error for my private plugin?",id:"why-do-i-get-a-field-is-required-rooturls-error-for-my-private-plugin",level:3}],s={toc:p},g="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(g,(0,a.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("head",null,(0,i.kt)("meta",{name:"robots",content:"noindex"})),(0,i.kt)("p",null,"Grafana requires all plugins to be signed so that we can verify their authenticity with signature verification."),(0,i.kt)("p",null,"All Grafana Labs-authored backend plugins, including Enterprise plugins, are signed. By default, Grafana ",(0,i.kt)("strong",{parentName:"p"},"requires")," all plugins to be signed in order for them to be loaded."),(0,i.kt)("p",null,"Before you can sign your plugin, you need to decide whether you want to sign it as a ",(0,i.kt)("em",{parentName:"p"},"public")," or a ",(0,i.kt)("em",{parentName:"p"},"private")," plugin."),(0,i.kt)("p",null,"To make your plugin publicly available outside of your organization, sign your plugin under a ",(0,i.kt)("em",{parentName:"p"},"community")," or ",(0,i.kt)("em",{parentName:"p"},"commercial")," signature level. Public plugins are available from the Grafana plugin catalog and can be installed by anyone."),(0,i.kt)("p",null,"If you intend to only use the plugin within your organization, sign it under a ",(0,i.kt)("em",{parentName:"p"},"private")," signature level."),(0,i.kt)("h2",{id:"generate-an-api-key"},"Generate an API key"),(0,i.kt)("p",null,"To verify ownership of your plugin, generate an API key that you'll use every time you need to sign a new version of your plugin."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Create a Grafana Cloud account.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Make sure that the first part of the plugin ID matches the slug of your Grafana Cloud account."),(0,i.kt)("p",{parentName:"li"},"You can find the plugin ID in the ",(0,i.kt)("inlineCode",{parentName:"p"},"plugin.json")," file inside your plugin directory. For example, if your account slug is ",(0,i.kt)("inlineCode",{parentName:"p"},"acmecorp"),", you need to prefix the plugin ID with ",(0,i.kt)("inlineCode",{parentName:"p"},"acmecorp-"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Create a Grafana Cloud API key with the ",(0,i.kt)("strong",{parentName:"p"},"PluginPublisher")," role."))),(0,i.kt)("h2",{id:"sign-a-public-plugin"},"Sign a public plugin"),(0,i.kt)("p",null,"Public plugins need to be reviewed by the Grafana team before you can sign them."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Submit your plugin for review.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"If we approve your plugin, you're granted a plugin signature level. You need this signature level to proceed.")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In your plugin directory, sign the plugin with the API key you just created. Grafana Sign Plugin creates a MANIFEST.txt file in the ",(0,i.kt)("inlineCode",{parentName:"p"},"dist")," directory of your plugin:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"export GRAFANA_API_KEY=<YOUR_API_KEY>\nnpx @grafana/sign-plugin@latest\n")))),(0,i.kt)("h2",{id:"sign-a-private-plugin"},"Sign a private plugin"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"In your plugin directory, sign the plugin with the API key you just created. Grafana Sign Plugin creates a MANIFEST.txt file in the ",(0,i.kt)("inlineCode",{parentName:"p"},"dist")," directory of your plugin."),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"export GRAFANA_API_KEY=<YOUR_API_KEY>\nnpx @grafana/sign-plugin@latest --rootUrls https://example.com/grafana\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"After the ",(0,i.kt)("inlineCode",{parentName:"p"},"rootUrls")," flag, enter a comma-separated list of URLs for the Grafana instances where you intend to install the plugin."))),(0,i.kt)("h2",{id:"plugin-signature-levels"},"Plugin signature levels"),(0,i.kt)("p",null,"To sign a plugin, you need to select the ",(0,i.kt)("em",{parentName:"p"},"signature level")," that you want to sign it under. The signature level of your plugin determines how you can distribute it."),(0,i.kt)("p",null,"You can sign your plugin under three different ",(0,i.kt)("em",{parentName:"p"},"signature levels"),": ",(0,i.kt)("em",{parentName:"p"},"private"),", ",(0,i.kt)("em",{parentName:"p"},"community"),", and ",(0,i.kt)("em",{parentName:"p"},"commercial"),"."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"th"},"Plugin Level")),(0,i.kt)("th",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"th"},"Paid Subscription Required?")),(0,i.kt)("th",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"th"},"Description")))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Private"),(0,i.kt)("td",{parentName:"tr",align:null},"No;Free of charge"),(0,i.kt)("td",{parentName:"tr",align:null},"You can create and sign a Private plugin for any technology at no charge.Private plugins are intended for use on your own installation of Grafana. They may not be distributed to the Grafana community, and they are not published in the Grafana plugin catalog.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Community"),(0,i.kt)("td",{parentName:"tr",align:null},"No;Free of charge"),(0,i.kt)("td",{parentName:"tr",align:null},"You can create, sign, and distribute plugins at no charge, provided that all dependent technologies are open source and not for profit.Community plugins are published in the official Grafana catalog, and are available to the entire Grafana community.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Commercial"),(0,i.kt)("td",{parentName:"tr",align:null},"Yes;Commercial plugin subscription required"),(0,i.kt)("td",{parentName:"tr",align:null},"You can create, sign, and distribute plugins with dependent technologies that are closed source or commercially backed. To do so, enter into a Commercial plugin subscription with Grafana Labs.Commercial plugins are published on the Grafana plugin catalog, and are available to the entire Grafana community.")))),(0,i.kt)("p",null,"For instructions on how to sign a plugin under the Community and Commercial signature level, refer to Sign a public plugin."),(0,i.kt)("p",null,"For instructions on how to sign a plugin under the Private signature level, refer to Sign a private plugin."),(0,i.kt)("h2",{id:"plugin-manifest"},"Plugin manifest"),(0,i.kt)("p",null,"For Grafana to verify the digital signature of a plugin, the plugin must include a signed manifest file, ",(0,i.kt)("inlineCode",{parentName:"p"},"MANIFEST.txt"),". The signed manifest file contains two sections:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Signed message -")," Contains plugin metadata and plugin files with their respective checksums (SHA256)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Digital signature -")," Created by encrypting the signed message using a private key. Grafana has a public key built-in that can be used to verify that the digital signature has been encrypted using the expected private key.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Example")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-txt"},'-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\n{\n  "manifestVersion": "2.0.0",\n  "signatureType": "community",\n  "signedByOrg": "myorgid",\n  "signedByOrgName": "My Org",\n  "plugin": "myorgid-simple-panel",\n  "version": "1.0.0",\n  "time": 1602753404133,\n  "keyId": "7e4d0c6a708866e7",\n  "files": {\n    "LICENSE": "12ab7a0961275f5ce7a428e662279cf49bab887d12b2ff7bfde738346178c28c",\n    "module.js.LICENSE.txt": "0d8f66cd4afb566cb5b7e1540c68f43b939d3eba12ace290f18abc4f4cb53ed0",\n    "module.js.map": "8a4ede5b5847dec1c6c30008d07bef8a049408d2b1e862841e30357f82e0fa19",\n    "plugin.json": "13be5f2fd55bee787c5413b5ba6a1fae2dfe8d2df6c867dadc4657b98f821f90",\n    "README.md": "2d90145b28f22348d4f50a81695e888c68ebd4f8baec731fdf2d79c8b187a27f",\n    "module.js": "b4b6945bbf3332b08e5e1cb214a5b85c82557b292577eb58c8eb1703bc8e4577"\n  }\n}\n-----BEGIN PGP SIGNATURE-----\nVersion: OpenPGP.js v4.10.1\nComment: https://openpgpjs.org\n\nwqEEARMKAAYFAl+IE3wACgkQfk0ManCIZudpdwIHTCqjVzfm7DechTa7BTbd\n+dNIQtwh8Tv2Q9HksgN6c6M9nbQTP0xNHwxSxHOI8EL3euz/OagzWoiIWulG\n7AQo7FYCCQGucaLPPK3tsWaeFqVKy+JtQhrJJui23DAZLSYQYZlKQ+nFqc9x\nT6scfmuhWC/TOcm83EVoCzIV3R5dOTKHqkjIUg==\n=GdNq\n-----END PGP SIGNATURE-----\n')),(0,i.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,i.kt)("h3",{id:"why-do-i-get-a-modified-signature-error"},'Why do I get a "Modified signature" error?'),(0,i.kt)("p",null,"In some cases an invalid ",(0,i.kt)("inlineCode",{parentName:"p"},"MANIFEST.txt")," is generated because of an issue when signing the plugin on Windows. You can fix this by replacing all double backslashes, ",(0,i.kt)("inlineCode",{parentName:"p"},"\\\\"),", with a forward slash, ",(0,i.kt)("inlineCode",{parentName:"p"},"/"),", in the ",(0,i.kt)("inlineCode",{parentName:"p"},"MANIFEST.txt")," file. You need to do this every time you sign your plugin."),(0,i.kt)("h3",{id:"why-do-i-get-a-field-is-required-rooturls-error-for-my-public-plugin"},'Why do I get a "Field is required: ',(0,i.kt)("inlineCode",{parentName:"h3"},"rootUrls"),'" error for my public plugin?'),(0,i.kt)("p",null,"With a ",(0,i.kt)("strong",{parentName:"p"},"public")," plugin, your plugin doesn't have a plugin signature level assigned to it yet. A Grafana team member will assign a signature level to your plugin once it has been reviewed and approved. For more information, refer to Sign a public plugin."),(0,i.kt)("h3",{id:"why-do-i-get-a-field-is-required-rooturls-error-for-my-private-plugin"},'Why do I get a "Field is required: ',(0,i.kt)("inlineCode",{parentName:"h3"},"rootUrls"),'" error for my private plugin?'),(0,i.kt)("p",null,"With a ",(0,i.kt)("strong",{parentName:"p"},"private")," plugin, you need to add a ",(0,i.kt)("inlineCode",{parentName:"p"},"rootUrls")," flag to the ",(0,i.kt)("inlineCode",{parentName:"p"},"plugin:sign")," command. The ",(0,i.kt)("inlineCode",{parentName:"p"},"rootUrls")," must match the root_url configuration. For more information, refer to Sign a private plugin."),(0,i.kt)("p",null,"If you still get this error, make sure that the API key was generated by a Grafana Cloud account that matches the first part of the plugin ID."))}d.isMDXComponent=!0}}]);