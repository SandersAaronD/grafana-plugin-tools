"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[120],{876:(e,a,t)=>{t.d(a,{Zo:()=>d,kt:()=>u});var n=t(2784);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function s(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=n.createContext({}),m=function(e){var a=n.useContext(l),t=a;return e&&(t="function"==typeof e?e(a):i(i({},a),e)),t},d=function(e){var a=m(e.components);return n.createElement(l.Provider,{value:a},e.children)},p="mdxType",f={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},c=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=m(t),c=r,u=p["".concat(l,".").concat(c)]||p[c]||f[c]||o;return t?n.createElement(u,i(i({ref:a},d),{},{components:t})):n.createElement(u,i({ref:a},d))}));function u(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var o=t.length,i=new Array(o);i[0]=c;var s={};for(var l in a)hasOwnProperty.call(a,l)&&(s[l]=a[l]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var m=2;m<o;m++)i[m]=t[m];return n.createElement.apply(null,i)}return n.createElement.apply(null,t)}c.displayName="MDXCreateElement"},7934:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>i,default:()=>f,frontMatter:()=>o,metadata:()=>s,toc:()=>m});var n=t(7896),r=(t(2784),t(876));const o={id:"data-frames",title:"Data frames",sidebar_position:4},i="Data frames",s={unversionedId:"introduction/data-frames",id:"introduction/data-frames",title:"Data frames",description:"Grafana supports a variety of different data sources, each with its own data model. To make this possible, Grafana consolidates the query results from each of these data sources into one unified data structure called a data frame.",source:"@site/../docs/introduction/data-frames.md",sourceDirName:"introduction",slug:"/introduction/data-frames",permalink:"/plugin-tools/docs/introduction/data-frames",draft:!1,editUrl:"https://github.com/grafana/plugin-tools/edit/main/docusaurus/website/../docs/introduction/data-frames.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{id:"data-frames",title:"Data frames",sidebar_position:4},sidebar:"docs",previous:{title:"Plugin protocol",permalink:"/plugin-tools/docs/introduction/plugin-protocol"},next:{title:"Get started",permalink:"/plugin-tools/docs/get-started/"}},l={},m=[{value:"Data frame fields",id:"data-frame-fields",level:2},{value:"Field configurations",id:"field-configurations",level:2},{value:"Data transformations",id:"data-transformations",level:2},{value:"Data frames as time series",id:"data-frames-as-time-series",level:2},{value:"Wide format",id:"wide-format",level:3},{value:"Long format",id:"long-format",level:3},{value:"Technical references",id:"technical-references",level:2},{value:"Apache Arrow",id:"apache-arrow",level:3},{value:"Javascript",id:"javascript",level:3},{value:"Go",id:"go",level:3}],d={toc:m},p="wrapper";function f(e){let{components:a,...t}=e;return(0,r.kt)(p,(0,n.Z)({},d,t,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"data-frames"},"Data frames"),(0,r.kt)("p",null,"Grafana supports a variety of different data sources, each with its own data model. To make this possible, Grafana consolidates the query results from each of these data sources into one unified data structure called a ",(0,r.kt)("em",{parentName:"p"},"data frame"),"."),(0,r.kt)("p",null,"The data frame structure is a concept that's borrowed from data analysis tools like the ",(0,r.kt)("a",{parentName:"p",href:"https://www.r-project.org"},"R programming language")," and ",(0,r.kt)("a",{parentName:"p",href:"https://pandas.pydata.org/"},"Pandas"),"."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Data frames are available in Grafana 7.0+, and replaced the Time series and Table structures with a more generic data structure that can support a wider range of data types.")),(0,r.kt)("p",null,"This document gives an overview of the data frame structure, and of how data is handled within Grafana."),(0,r.kt)("h2",{id:"data-frame-fields"},"Data frame fields"),(0,r.kt)("p",null,"A data frame is a collection of ",(0,r.kt)("em",{parentName:"p"},"fields"),", where each field corresponds to a column. Each field, in turn, consists of a collection of values and metadata, such as the data type of those values."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"export interface Field<T = any, V = Vector<T>> {\n  /**\n   * Name of the field (column)\n   */\n  name: string;\n  /**\n   *  Field value type (string, number, and so on)\n   */\n  type: FieldType;\n  /**\n   *  Meta info about how field and how to display it\n   */\n  config: FieldConfig;\n\n  /**\n   * The raw field values\n   * In Grafana 10, this accepts both simple arrays and the Vector interface\n   * In Grafana 11, the Vector interface will be removed\n   */\n  values: V | T[];\n\n  /**\n   * When type === FieldType.Time, this can optionally store\n   * the nanosecond-precison fractions as integers between\n   * 0 and 999999.\n   */\n  nanos?: number[];\n\n  labels?: Labels;\n\n  /**\n   * Cached values with appropriate display and id values\n   */\n  state?: FieldState | null;\n\n  /**\n   * Convert a value for display\n   */\n  display?: DisplayProcessor;\n\n  /**\n   * Get value data links with variables interpolated\n   */\n  getLinks?: (config: ValueLinkConfig) => Array<LinkModel<Field>>;\n}\n")),(0,r.kt)("p",null,"Let's look at an example. The following table demonstrates a data frame with two fields, ",(0,r.kt)("em",{parentName:"p"},"time")," and ",(0,r.kt)("em",{parentName:"p"},"temperature"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"time"),(0,r.kt)("th",{parentName:"tr",align:null},"temperature"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2020-01-02 03:04:00"),(0,r.kt)("td",{parentName:"tr",align:null},"45.0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2020-01-02 03:05:00"),(0,r.kt)("td",{parentName:"tr",align:null},"47.0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2020-01-02 03:06:00"),(0,r.kt)("td",{parentName:"tr",align:null},"48.0")))),(0,r.kt)("p",null,"Each field has three values, and each value in a field must share the same type. In this case, all values in the ",(0,r.kt)("inlineCode",{parentName:"p"},"time")," field are timestamps, and all values in the ",(0,r.kt)("inlineCode",{parentName:"p"},"temperature")," field are numbers."),(0,r.kt)("p",null,"One restriction on data frames is that all fields in the frame must be of the same length to be a valid data frame."),(0,r.kt)("h2",{id:"field-configurations"},"Field configurations"),(0,r.kt)("p",null,"Each field in a data frame contains optional information about the values in the field, such as units, scaling, and so on."),(0,r.kt)("p",null,"By adding field configurations to a data frame, Grafana can configure visualizations automatically. For example, you could configure Grafana to automatically set the unit provided by the data source."),(0,r.kt)("h2",{id:"data-transformations"},"Data transformations"),(0,r.kt)("p",null,"We have seen how field configs contain type information, and they also have another role. Data frame fields enable ",(0,r.kt)("em",{parentName:"p"},"data transformations")," within Grafana."),(0,r.kt)("p",null,"A data transformation is any function that accepts a data frame as input, and returns another data frame as output. By using data frames in your plugin, you get a range of transformations for free."),(0,r.kt)("p",null,"To learn more about data transformations in Grafana, refer to ",(0,r.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/panels-visualizations/query-transform-data/transform-data"},"Transform data"),"."),(0,r.kt)("h2",{id:"data-frames-as-time-series"},"Data frames as time series"),(0,r.kt)("p",null,"A data frame with at least one time field is considered a ",(0,r.kt)("em",{parentName:"p"},"time series"),"."),(0,r.kt)("p",null,"For more information on time series, refer to our ",(0,r.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/fundamentals/timeseries/"},"Introduction to time series"),"."),(0,r.kt)("h3",{id:"wide-format"},"Wide format"),(0,r.kt)("p",null,"When a collection of time series shares the same ",(0,r.kt)("em",{parentName:"p"},"time index"),"\u2014the time fields in each time series are identical\u2014they can be stored together, in a ",(0,r.kt)("em",{parentName:"p"},"wide")," format. By reusing the time field, less data is sent to the browser."),(0,r.kt)("p",null,"In this example, the ",(0,r.kt)("inlineCode",{parentName:"p"},"cpu")," usage from each host shares the time index, so we can store them in the same data frame:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"Name: Wide\nDimensions: 3 fields by 2 rows\n+---------------------+-----------------+-----------------+\n| Name: time          | Name: cpu       | Name: cpu       |\n| Labels:             | Labels: host=a  | Labels: host=b  |\n| Type: []time.Time   | Type: []float64 | Type: []float64 |\n+---------------------+-----------------+-----------------+\n| 2020-01-02 03:04:00 | 3               | 4               |\n| 2020-01-02 03:05:00 | 6               | 7               |\n+---------------------+-----------------+-----------------+\n")),(0,r.kt)("p",null,"However, if the two time series don't share the same time values, they are represented as two distinct data frames:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"Name: cpu\nDimensions: 2 fields by 2 rows\n+---------------------+-----------------+\n| Name: time          | Name: cpu       |\n| Labels:             | Labels: host=a  |\n| Type: []time.Time   | Type: []float64 |\n+---------------------+-----------------+\n| 2020-01-02 03:04:00 | 3               |\n| 2020-01-02 03:05:00 | 6               |\n+---------------------+-----------------+\n\nName: cpu\nDimensions: 2 fields by 2 rows\n+---------------------+-----------------+\n| Name: time          | Name: cpu       |\n| Labels:             | Labels: host=b  |\n| Type: []time.Time   | Type: []float64 |\n+---------------------+-----------------+\n| 2020-01-02 03:04:01 | 4               |\n| 2020-01-02 03:05:01 | 7               |\n+---------------------+-----------------+\n")),(0,r.kt)("p",null,"A typical use for the wide format is when multiple time series are collected by the same process. In this case, every measurement is made at the same interval and therefore shares the same time values."),(0,r.kt)("h3",{id:"long-format"},"Long format"),(0,r.kt)("p",null,"Some data sources return data in a ",(0,r.kt)("em",{parentName:"p"},"long")," format (also called ",(0,r.kt)("em",{parentName:"p"},"narrow")," format). This is a common format returned by, for example, SQL databases."),(0,r.kt)("p",null,"In the long format, string values are represented as separate fields rather than as labels. As a result, a data form in long form may have duplicated time values."),(0,r.kt)("p",null,"Grafana can detect and convert data frames in long format into wide format."),(0,r.kt)("p",null,"For example, the following data frame appears in long format:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"Name: Long\nDimensions: 4 fields by 4 rows\n+---------------------+-----------------+-----------------+----------------+\n| Name: time          | Name: aMetric   | Name: bMetric   | Name: host     |\n| Labels:             | Labels:         | Labels:         | Labels:        |\n| Type: []time.Time   | Type: []float64 | Type: []float64 | Type: []string |\n+---------------------+-----------------+-----------------+----------------+\n| 2020-01-02 03:04:00 | 2               | 10              | foo            |\n| 2020-01-02 03:04:00 | 5               | 15              | bar            |\n| 2020-01-02 03:05:00 | 3               | 11              | foo            |\n| 2020-01-02 03:05:00 | 6               | 16              | bar            |\n+---------------------+-----------------+-----------------+----------------+\n")),(0,r.kt)("p",null,"The above table can be converted into a data frame in wide format like this:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"Name: Wide\nDimensions: 5 fields by 2 rows\n+---------------------+------------------+------------------+------------------+------------------+\n| Name: time          | Name: aMetric    | Name: bMetric    | Name: aMetric    | Name: bMetric    |\n| Labels:             | Labels: host=foo | Labels: host=foo | Labels: host=bar | Labels: host=bar |\n| Type: []time.Time   | Type: []float64  | Type: []float64  | Type: []float64  | Type: []float64  |\n+---------------------+------------------+------------------+------------------+------------------+\n| 2020-01-02 03:04:00 | 2                | 10               | 5                | 15               |\n| 2020-01-02 03:05:00 | 3                | 11               | 6                | 16               |\n+---------------------+------------------+------------------+------------------+------------------+\n")),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Not all panels support the wide time series data frame format. To keep full backward compatibility Grafana has introduced a transformation that you can use to convert from the wide to the long format. For usage information, refer to the ",(0,r.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/panels-visualizations/query-transform-data/transform-data#prepare-time-series"},"Prepare time series-transformation"),".")),(0,r.kt)("h2",{id:"technical-references"},"Technical references"),(0,r.kt)("p",null,"The concept of a data frame in Grafana is borrowed from data analysis tools like the ",(0,r.kt)("a",{parentName:"p",href:"https://www.r-project.org"},"R programming language"),", and ",(0,r.kt)("a",{parentName:"p",href:"https://pandas.pydata.org/"},"Pandas"),". Other technical references are provided below."),(0,r.kt)("h3",{id:"apache-arrow"},"Apache Arrow"),(0,r.kt)("p",null,"The data frame structure is inspired by, and uses the ",(0,r.kt)("a",{parentName:"p",href:"https://arrow.apache.org/"},"Apache Arrow Project"),". Javascript Data frames use Arrow Tables as the underlying structure, and the backend Go code serializes its Frames in Arrow Tables for transmission."),(0,r.kt)("h3",{id:"javascript"},"Javascript"),(0,r.kt)("p",null,"The Javascript implementation of data frames is in the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/grafana/grafana/tree/main/packages/grafana-data/src/dataframe"},(0,r.kt)("inlineCode",{parentName:"a"},"/src/dataframe")," folder")," and ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/grafana/grafana/blob/main/packages/grafana-data/src/types/dataFrame.ts"},(0,r.kt)("inlineCode",{parentName:"a"},"/src/types/dataframe.ts"))," of the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/grafana/grafana/tree/main/packages/grafana-data"},(0,r.kt)("inlineCode",{parentName:"a"},"@grafana/data")," package"),"."),(0,r.kt)("h3",{id:"go"},"Go"),(0,r.kt)("p",null,"For documentation on the Go implementation of data frames, refer to the ",(0,r.kt)("a",{parentName:"p",href:"https://pkg.go.dev/github.com/grafana/grafana-plugin-sdk-go/data?tab=doc"},"github.com/grafana/grafana-plugin-sdk-go/data package"),"."))}f.isMDXComponent=!0}}]);