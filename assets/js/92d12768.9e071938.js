"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[580],{876:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(2784);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),u=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(a),m=r,h=p["".concat(l,".").concat(m)]||p[m]||d[m]||s;return a?n.createElement(h,o(o({ref:t},c),{},{components:a})):n.createElement(h,o({ref:t},c))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=a.length,o=new Array(s);o[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:r,o[1]=i;for(var u=2;u<s;u++)o[u]=a[u];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},1903:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>u});var n=a(7896),r=(a(2784),a(876));const s={id:"backend-plugins",title:"Backend plugins"},o="Backend plugins",i={unversionedId:"introduction/backend-plugins",id:"introduction/backend-plugins",title:"Backend plugins",description:"The Grafana plugin system for backend development allows you to integrate Grafana with virtually anything and offer custom visualizations. This document explains the system's background, use cases, and key features.",source:"@site/../docs/introduction/backend.md",sourceDirName:"introduction",slug:"/introduction/backend-plugins",permalink:"/plugin-tools/docs/introduction/backend-plugins",draft:!1,editUrl:"https://github.com/grafana/plugin-tools/edit/main/docusaurus/website/../docs/introduction/backend.md",tags:[],version:"current",frontMatter:{id:"backend-plugins",title:"Backend plugins"},sidebar:"docs",next:{title:"Grafana plugin SDK for Go",permalink:"/plugin-tools/docs/introduction/grafana-plugin-sdk-for-go"}},l={},u=[{value:"Background",id:"background",level:2},{value:"Use cases for implementing a backend plugin",id:"use-cases-for-implementing-a-backend-plugin",level:2},{value:"Grafana backend plugin system",id:"grafana-backend-plugin-system",level:2},{value:"Benefits for plugin development",id:"benefits-for-plugin-development",level:3},{value:"Capabilities of the backend plugin system",id:"capabilities-of-the-backend-plugin-system",level:3},{value:"Query data",id:"query-data",level:4},{value:"Resources",id:"resources",level:4},{value:"Use cases",id:"use-cases",level:3},{value:"Health checks",id:"health-checks",level:4},{value:"Collect metrics",id:"collect-metrics",level:4},{value:"Streaming",id:"streaming",level:4}],c={toc:u},p="wrapper";function d(e){let{components:t,...a}=e;return(0,r.kt)(p,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"backend-plugins"},"Backend plugins"),(0,r.kt)("p",null,"The Grafana plugin system for backend development allows you to integrate Grafana with virtually anything and offer custom visualizations. This document explains the system's background, use cases, and key features."),(0,r.kt)("h2",{id:"background"},"Background"),(0,r.kt)("p",null,"Grafana added support for ",(0,r.kt)("em",{parentName:"p"},"frontend plugins")," in version 3.0 so that the Grafana community could create custom panels and data sources. It was wildly successful and has made Grafana much more useful for our user community."),(0,r.kt)("p",null,"However, one limitation of these plugins is that they run on the client side, in the browser. Therefore, they can't support use cases that require server-side features."),(0,r.kt)("p",null,"Since Grafana v7.0, we have supported server-side plugins that remove this limitation. We use the term ",(0,r.kt)("em",{parentName:"p"},"backend plugin")," to denote that a plugin has a backend component. A backend plugin usually requires frontend components as well. For example, some backend data source plugins need query editor components on the frontend."),(0,r.kt)("h2",{id:"use-cases-for-implementing-a-backend-plugin"},"Use cases for implementing a backend plugin"),(0,r.kt)("p",null,"The following examples give some common use cases for backend plugins:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Enable ",(0,r.kt)("a",{parentName:"li",href:"https://grafana.com/docs/grafana/latest/alerting/"},"Grafana Alerting")," for data sources."),(0,r.kt)("li",{parentName:"ul"},"Connect to SQL database servers and other non-HTTP services that normally can't be connected to from a browser."),(0,r.kt)("li",{parentName:"ul"},"Keep state between users, for example, by query caching for data sources."),(0,r.kt)("li",{parentName:"ul"},"Use custom authentication methods and/or authorization checks that aren't supported in Grafana."),(0,r.kt)("li",{parentName:"ul"},"Use a custom data source request proxy (refer to ",(0,r.kt)("a",{parentName:"li",href:"#resources"},"Resources")," for more information).")),(0,r.kt)("h2",{id:"grafana-backend-plugin-system"},"Grafana backend plugin system"),(0,r.kt)("p",null,"The Grafana backend plugin system is based on HashiCorp's ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/hashicorp/go-plugin"},"Go Plugin System over RPC"),". Our implementation of the Grafana server launches each backend plugin as a subprocess and communicates with it over ",(0,r.kt)("a",{parentName:"p",href:"https://grpc.io/"},"gRPC"),"."),(0,r.kt)("h3",{id:"benefits-for-plugin-development"},"Benefits for plugin development"),(0,r.kt)("p",null,"Grafana's approach has benefits for developers:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Stability:")," Plugins can't crash your Grafana process: a panic in a plugin doesn't panic the server."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Ease of development:")," Grafana provides an officially supported SDK for Go and tooling to help create plugins."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Security:")," Plugins only have access to the interfaces and arguments given to them, not to the entire memory space of the process.")),(0,r.kt)("h3",{id:"capabilities-of-the-backend-plugin-system"},"Capabilities of the backend plugin system"),(0,r.kt)("p",null,"Grafana's backend plugin system exposes several key capabilities, or building blocks, that your backend plugin can implement:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Query data"),(0,r.kt)("li",{parentName:"ul"},"Resources"),(0,r.kt)("li",{parentName:"ul"},"Health checks"),(0,r.kt)("li",{parentName:"ul"},"Collect metrics"),(0,r.kt)("li",{parentName:"ul"},"Streaming")),(0,r.kt)("h4",{id:"query-data"},"Query data"),(0,r.kt)("p",null,"The query data capability allows a backend plugin to handle data source queries that are submitted from a ",(0,r.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/dashboards"},"dashboard"),", ",(0,r.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/explore"},"Explore")," or ",(0,r.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/alerting"},"Grafana Alerting"),". The response contains ",(0,r.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/developers/plugins/introduction-to-plugin-development/data-frames/"},"data frames"),", which are used to visualize metrics, logs, and traces."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Backend data source plugins are required to implement the query data capability.")),(0,r.kt)("h4",{id:"resources"},"Resources"),(0,r.kt)("p",null,"The resources capability allows a backend plugin to handle custom HTTP requests sent to the Grafana HTTP API and respond with custom HTTP responses. Here, the request and response formats can vary. For example, you can use JSON, plain text, HTML, or static resources such as images and files, and so on."),(0,r.kt)("p",null,"Compared to the query data capability, where the response contains data frames, the resources capability gives the plugin developer more flexibility for extending and opening up Grafana for new and interesting use cases."),(0,r.kt)("h3",{id:"use-cases"},"Use cases"),(0,r.kt)("p",null,"Examples of use cases for implementing resources:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Implement a custom data source proxy to provide certain authentication, authorization, or other requirements that are not supported in Grafana's ",(0,r.kt)("a",{parentName:"li",href:"https://grafana.com/docs/grafana/latest/developers/http_api/#data-source-proxy-calls"},"built-in data proxy"),"."),(0,r.kt)("li",{parentName:"ul"},"Return data or information in a format suitable for use within a data source query editor to provide auto-complete functionality."),(0,r.kt)("li",{parentName:"ul"},"Return static resources such as images or files."),(0,r.kt)("li",{parentName:"ul"},"Send a command to a device, such as a microcontroller or IoT device."),(0,r.kt)("li",{parentName:"ul"},"Request information from a device, such as a microcontroller or IoT device."),(0,r.kt)("li",{parentName:"ul"},"Extend Grafana's HTTP API with custom resources, methods and actions."),(0,r.kt)("li",{parentName:"ul"},"Use ",(0,r.kt)("a",{parentName:"li",href:"https://en.wikipedia.org/wiki/Chunked_transfer_encoding"},"chunked transfer encoding")," to return large data responses in chunks or to enable certain streaming capabilities.")),(0,r.kt)("h4",{id:"health-checks"},"Health checks"),(0,r.kt)("p",null,"The health checks capability allows a backend plugin to return the status of the plugin. For data source backend plugins, the health check is automatically called when a user edits a data source and selects ",(0,r.kt)("em",{parentName:"p"},"Save & Test")," in the UI."),(0,r.kt)("p",null,"A plugin's health check endpoint is exposed in the Grafana HTTP API and allows external systems to continuously poll the plugin's health to make sure that it's running and working as expected."),(0,r.kt)("h4",{id:"collect-metrics"},"Collect metrics"),(0,r.kt)("p",null,"A backend plugin can collect and return runtime, process, and custom metrics using the text-based Prometheus ",(0,r.kt)("a",{parentName:"p",href:"https://prometheus.io/docs/instrumenting/exposition_formats/"},"exposition format"),". If you're using the ",(0,r.kt)("a",{parentName:"p",href:"/plugin-tools/docs/introduction/grafana-plugin-sdk-for-go"},"Grafana Plugin SDK for Go")," to implement your backend plugin, then the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/prometheus/client_golang"},"Prometheus instrumentation library for Go applications")," is built-in. This SDK gives you Go runtime metrics and process metrics out of the box. You can use the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/prometheus/client_golang"},"Prometheus instrumentation library")," to add custom metrics to instrument your backend plugin."),(0,r.kt)("p",null,"The Grafana HTTP API offers an endpoint (",(0,r.kt)("inlineCode",{parentName:"p"},"/api/plugins/<plugin id>/metrics"),") that allows you to configure a Prometheus instance to scrape the metrics."),(0,r.kt)("h4",{id:"streaming"},"Streaming"),(0,r.kt)("p",null,"The streaming capability allows a backend plugin to handle data source queries that are streaming. For more information, refer to ",(0,r.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/developers/plugins/create-a-grafana-plugin/develop-a-plugin/build-a-streaming-data-source-plugin/"},"Build a streaming data source plugin"),"."))}d.isMDXComponent=!0}}]);